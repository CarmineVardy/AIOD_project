(Per qualsiasi lavoro accademico, bisogna sempre fare riferimento solo a Peer Review Paper)

Il dataset riguarda il congenital heart disease, quindi difetti cardiaci congeniti su bambini, su neonati ed
è riferito alle donne incinte. Questo fornito è il secondo dataset. Il primo dataset riguardava lo stesso
problema ma riferito a donne non incinte.

Per quanto riguarda la parte sperimentale con LC-MS, si può fare riferimento al paper che si trova online.

Questo dataset come detto riguarda i difetti cardiaci, un'ampia problematica perché può riguardare diverse anomalie
all'interno della diversa delle arterie e delle vene cardiache, ma anche le valvole, le pareti del cuore e
la separazione tra atrio e ventricolo. Quindi coprendo molte casistiche non è così facile identificare
l'impatto biologico specifico. Non sono pochi i casi purtroppo, anche se dal punto di vista statistico
è abbastanza raro, sotto l'1% della popolazione però comunque ci sono sufficienti casi.

Il primo paper pubblicato riguarda l'analisi del plasma delle mamme non incinte che avevano avuto dei bambini
o più bambini che presentavano un difetto cardiaco perché da studi procedenti si è evinto che in realtà è una
patologia che trasmette la mamma, non dipende dal padre ma dipende dalla madre per questo noi ci siamo
organizzati sulla signature del plasma delle mamme.

Noi cosa abbiamo fatto?
Avevamo sostanzialmente quattro dataset, un descritto di un numero di pazienti di cui abbiamo analizzato il plasma
con lipidomica e metabolomica. Sappiamo che dobbiamo analizzare le molecole positivo e negativo in maniera
differente quindi abbiamo:
-lipidomica positiva
-lipidomica negativa
-metabolomica positiva
-metabolimica negativa
e le abbiamo analizzate come single block quindi dei modelli di classificazione indipendenti su ogni blocco.
Quindi ho accorpato i blocchi di positivo e negativo di lipidomica e i blocchi di metabolomica positivo e
negativo in modo da ottenere un unico data set di lipidomica e un unico data set di metabolomica e un
data set che fondeva lipidomica e metabolomica. Non è banale come cosa perché vedete che il numero di
variabili aumenta tantissimo e ottenevamo dei risultati anche in validazione molto
promettenti soprattutto dal punto di vista dell'utilizzo della metabolomica.

Successivamente abbiamo applicato un modello specifico middle level fusion che fa una selezione di
variabili a priori ottenendo così delle performance per quanto riguarda l'accuratezza di all'incirca
il 94% nella situazione più ottimale, ovvero utilizzando sostanzialmente un quantitativo di molecole
molto basso, facendo una selezione di variabili a priori di meno di 15 variabili per combinazione.

Anche nella classificazione di un secondo caso che era una patologia specifica del CHD si ottenevano
dei risultati promettenti, sulle donne dopo la gravidanza, non incinte (primo dataset).

Ovviamente dovevamo dire che quelle 15 variabili che avevamo selezionato potessero dipendere
da BMI e GSEX e invece poi quelle variabili significative le abbiamo studiate rispetto ai
parametri demografici e abbiamo visto che in realtà non dipendevo dai parametri demografici
che abbiamo registrato perché chiaramente in questo caso non è che noi possiamo fare troppo
schizzinosi e dire: "io mi prendo solo le donne che hanno una sola gravidanza, mi prendo
le donne dell'età dai 20 ai 35 anni, mi prendo le donne non fumatrice..", in questo
caso la campagna di raccolta dei campioni viene fatta in maniera non supervisionale nel
senso "quello che viene quello ti prendi" perché stiamo parlando comunque di numeri molto
bassi. In questo caso era una collaborazione con l'ospedale dell'università di Bristol quindi
la casistica della patologia dipendeva da quello che raccoglievano in ospedale mentre per
quanto riguarda gli esami era una corte di una databank.

Ora torniamo a noi, qual è il nostro scopo?
Identificare in questo nuovo dataset (il secondo) dove la campagna è effettuata su donne incinte
1)se c'è una differenza tra donne incinte con bambini che poi presentano malformazioni
cardiache rispetto a donne con healthy children
2)identificare quelli che possono essere successivamente valutati e validati come biomarcatori per tale patologia.
(Il concetto di biomarcatori all'interno della medicina e della biologia è un concetto molto
molto molto complesso. Non chiamate quelle molecole che troverete significative biomarcatori,
al massimo sono POTENZIALI biomarcatori perché i nostri metodi hanno un limite, i nostri dataset
sono ottenuti con LC-MS untargeted. Quando parlo di biomarcatore innanzitutto devono essere valori
quantitativi e devono essere valori che vengono validati su corti di centinaia e centinaia di pazienti
e devono essere campagne fatte all'interno, quindi non basta un dataset di 800 pazienti che..)

Quindi noi che cosa abbiamo fatto?
Abbiamo raccolto e studiato il plasma di donne incinte.

Di che cosa si compone il dataset fornito (il secondo)?
Abbiamo
-78 casi e 100 pazienti
Vedremo, importando il dataset, numeri più alti. Quando c'è "_00" e "_01" è perché su alcuni campioni
è stato preso un duplicato tecnico cioè è stato analizzato due volte per fare una valutazione di quella
che sia la riproducibilità tecnica strumentale.
(Se 01 ha lo stesso nome del precedente solo che cambia 01 anziché 00 è perché è un duplicato tecnico,
vuol dire che lo stesso campione è stato analizzato due volte)
Avendo solo di alcuni il duplicato, dobbiamo quindi rimuovere il secondo campione.
Se avessimo avuto un duplicato tecnico di tutti i campioni potevamo fare la media ma siccome noi ce
l'abbiamo non possiamo fare la media perché altrimenti alcuni campioni avrebbero un'informazione con
una robustezza differente di altri.


Quindi abbiamo questa corte di pazienti, abbiamo estratto il plasma che poi è stato analizzato in maniera
indipendente tra lipidomica e metabolomica.
Noi abbiamo solo i dati di metabolomica perché sono quelli che sono venuti meglio.

Che cosa ha fatto la prof e cosa ci presenta (il paper è in lavorazione)?
In maniera esplorativa ho fatto l'analisi delle componenti principali su i singoli blocchi quindi nel suo caso
4 blocchi: lipidomica positivo, lipidomica negativo, metabolomica positivo, metabolomica negativo.

Poi fusione dei dati di metabolomica e lipidomica utilizzando un algoritmo che si chiama CONDIM,

Su questo applicato un algoritmo per la selezione del training e del test set che si chiama DUPLEX,
in maniera tale di avere un training e un test set comune per tutti i blocchi.
(Questo è una aspetto importante, non è obbligatorio fondere i dati ma se volete comparare le performance
ottenute da due dataset chiaramente il dataset dei training e di test set devono essere gli stessi.
Se io voglio fare la comparazione se performa meglio il positivo o il negativo chiaramente il modello che
devo costruire è in maniera tale che siano comparabili quindi ci siano all'interno del training gli stessi
campioni per entrambi i dataset e non è che si può scegliere il training rispetto a uno o rispetto all'altro.
Lo scegliete in maniera che sia bilanciato l'optimum per tutte e due.)

Poi ho provato delle tecniche di classificazione: una banale PLS-DA, poi c'è un low-level fusion PLS-DA
e poi sPLS-DA che consente di selezionare le variabili. Tutto questo è stato validato in cross-validation
perché i campioni sono pochi quindi non ho potuto dividere il test in training, validazione e test
ma solo in training e validation, poi riportato e poi validato tramite il Nation Plan.

Quindi noi partiamo da questi due dataset (metabolomica positivo e negativo).
(Ovviamente non dovete fare lo stesso mio workflow)
Quindi avremo
-98 variabili e 52 variabili,
I dati sono stati già allineati, le variabili sono state già filtrate, e sono stati identificate.

Quindi partiamo da un dataset già pulito, abbastanza preprocessato e lavorato.
Quindi tutta la parte di smoothing, allineamento..quella parte lì non va fatta.

La divisione test e training l'ho fatta indipendente per i controlli e
indipendente per i casi in maniera tale che si fossero ottimizzati e poi i metodi per selezionare
training e test set.
Poi, siccome chiaramente avevamo un problema sulla parte di classificazione, siccome io sono
molto scettica su alcune tecniche tipo Random Forrest che è troppo ottimistico, tecniche
che chiaramente non sono fatte per questa tipologia di dati, o magari anche tecniche più
semplici che però per questa tipologia di dati diciamo non performano benissimo
come per esempio LDA, support vector machine, perché entrambe si basano sulla
dimensionalità del dataset e sulle distanze, quindi potrebbe essere difficile
la classificazione. Random Forrest non mi piace perché è randomico e ottimistico.
Però, nonostante io sia scettica, ho paragonato il mio modello ottimale con questi modelli
che in realtà vanno tanto di moda.

E poi mi sono posto un problema. Ho comunque troppi variabili, e quindi ho pensato che questi modelli potessero
performare male perché ci sono troppi variabili, e quindi ho provato ad applicare degli approcci
che possono essere di variabile reduction tipo MRMR, oppure di Space Reduction come la PCA, oppure l'applicazione di MRMR
e PCA insieme per vedere se riducendo prima il numero di variabili e poi massimizzando
l'informazione questi modelli potessero migliorare.

Poi l'altro approccio che ho approvato è la data augumentation che a voi piace tanto.
Mi sono focalizzata sulla classe minoritaria e ho cercato di proiettare nuovi campioni
rispetto alla classe minoritaria utilizzando diversi approcci.
Quindi con diversi livelli di complessità e diverse caratteristiche,
cioè tenendo in considerazione la classe maggioritaria, non tenendo
in considerazione la classe maggioritaria e via dicendo, questi sono i
cromatogrammi.
Noi non abbiamo gli spettri, quindi dobbiamo sempre plottare i dati.
O li plottate così, quindi a mezz'aria rispetto all'intensità o li plottata,
non so come fate la mappa, o fate la PCA ma ad ogni step, ad ogni preprocessamento
che voi fate sui dati dovete graficare per verificare se avete fatto qualche cosa che fa danno.

Queste sono le mie prime PCA sui singoli blocchi vedete che la differenziazione per quanto
riguarda la lipidomica non c'è, qualcosa si inizia a vedere per quanto riguarda la metabolomica e
soprattutto la metabolomica positiva, dove si vede lungo PC1 la separazione.

Poi questo è il risultato della fusione totale di tutti e quattro i blocchi però questa è una
situazione un po' più complessa.

E questi sono i risultati miei di classificazione quindi vedete che in cross-validation comunque
si ottengono dei buoni risultati per quanto riguarda la metabolomica in positivo, carichiamo circa
il 93%, sul test chiaramente si abbassa e scende al 77%, quando andiamo a fare la fusione teniamo
in considerazione tutte e due i metabolomi che si arriva sul test del 77%, poi questo in realtà è
perché la tecnica che faccio io di sPLS-DA, praticamente dipende dall'ordine con cui combinate
i blocchi quindi siccome dipende dall'ordine di combinazione, noi abbiamo quattro blocchi, io ho fatto tutte
le combinazioni quindi sono ci sono 64 modelli per valutare qual è l'accuratezza e come vedete
più o meno le accuratezze ritornano: sono in validazione intorno al 96-97% con un numero minimo
di variabili, otteniamo un ottimo risultato utilizzando tutti e quattro i blocchi dove abbiamo
un accuratezza del test set all'84% sostanzialmente utilizzando solo tre variabili, tre molecole:
una dalla lipidomica positiva e due dalla metabolomica positiva, questo è poi l'approccio.

Quando
io dico che è un ottimo risultato 84%, ma perché in questo caso specifico l'84% non è basso?
chi è che abbiamo analizzato? a chi abbiamo prelevato il sangue?
Alle madri incinte, immaginate lo sbalzo ormonale, il cambio metabolico che avviene all'interno di una donna
incinta, qui hanno provato a prenderlo allo stesso tempo il sangue della gravidanza però già vi
portate indietro una variabilità biologica molto alta, quando poi parlate degli studi sulle donne
tutto diventa ancora più complesso perché le donne hanno dei cicli, delle variazioni ormonali molto
più alte rispetto agli uomini, quando una donna è incinta questo diventa ancora più complesso quindi
stiamo parlando di una variabilità biologica assurda e l'84% in questo caso è un ottimo risultato.
Soprattutto stiamo parlando di una patologia che non è poi così chiara.

Come vedete io riporto i modelli ottimali per ogni cosa, non sono propri i modelli ottimali da
tutte le combinazioni di quello che vi ho presentato prima ma se questi sono i risultati ottimali
il mio modello batte tutte le qualsiasi combinazioni ottenute e anche il fatto che abbia provato
la data augmentation non ha portato grandi risultati innanzitutto perché i dati sintetici hanno
lasciato un po' di tempo che trovano, secondo perché chiaramente quelli si basano su una variabilità
che hanno già visto quindi il bilanciamento del dataset non ha portato nessun beneficio. Questo non
significa che voi non dobbiate provare.